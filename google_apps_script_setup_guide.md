# Google Apps Script 設定指南

## 優點
- ✅ 不需要Google Cloud專案
- ✅ 不需要API金鑰
- ✅ 直接在Google環境中執行
- ✅ 免費使用
- ✅ 自動處理權限

## 第一步：建立Google Apps Script專案

### 1.1 開啟Google Apps Script
1. 前往 [Google Apps Script](https://script.google.com/)
2. 點擊「新增專案」
3. 輸入專案名稱，例如「Google表單到簡報生成器」

### 1.2 設定專案
1. 在左側檔案列表中，點擊 `appsscript.json`
2. 將內容替換為我們提供的 `appsscript.json` 內容
3. 儲存檔案

## 第二步：複製程式碼

### 2.1 複製主要程式碼
1. 在 `Code.gs` 檔案中
2. 將我們提供的 `Code.gs` 內容完全替換
3. 儲存檔案

### 2.2 檢查程式碼
確保以下函數存在：
- `main()` - 主執行函數
- `getCurrentSheetData()` - 取得資料
- `processData()` - 處理資料
- `generateCharts()` - 生成圖表
- `createPresentation()` - 建立簡報
- `test()` - 測試函數

## 第三步：準備Google表單資料

### 3.1 建立或使用現有Google表單
1. 前往 [Google Forms](https://forms.google.com/)
2. 建立新表單或使用現有表單
3. 確保表單有回應資料

### 3.2 連結到試算表
1. 在表單中，點擊「回應」標籤
2. 點擊綠色的試算表圖示
3. 選擇「建立新試算表」或「選擇現有試算表」

### 3.3 確認資料格式
確保試算表包含：
- 第一行是標題行
- 資料從第二行開始
- 至少有一個數值欄位用於圖表

## 第四步：設定Apps Script權限

### 4.1 第一次執行
1. 在Apps Script編輯器中，點擊「執行」按鈕
2. 選擇 `main` 函數
3. 系統會要求授權

### 4.2 授權權限
1. 點擊「檢閱權限」
2. 選擇您的Google帳戶
3. 點擊「進階」
4. 點擊「前往 [專案名稱] (不安全)」
5. 點擊「允許」

## 第五步：自定義配置

### 5.1 修改CONFIG物件
在 `Code.gs` 中找到 `CONFIG` 物件，可以修改：

```javascript
const CONFIG = {
  // 簡報設定
  presentation: {
    title: '您的簡報標題',
    subtitle: '您的副標題'
  },
  
  // 圖表設定
  charts: [
    {
      type: 'bar',        // 圖表類型: bar, pie, line
      title: '圖表標題',
      xColumn: 0,         // X軸欄位索引 (從0開始)
      yColumn: 1          // Y軸欄位索引 (從0開始)
    }
  ],
  
  // 輸出設定
  output: {
    createSlides: true,   // 是否建立簡報
    createCharts: true,   // 是否建立圖表
    exportToDrive: true   // 是否匯出到Google Drive
  }
};
```

### 5.2 圖表類型說明
- `bar`: 長條圖
- `pie`: 圓餅圖
- `line`: 折線圖

### 5.3 欄位索引說明
- 第一欄 (標題) = 索引 0
- 第二欄 = 索引 1
- 第三欄 = 索引 2
- 以此類推...

## 第六步：執行和測試

### 6.1 測試執行
1. 在Apps Script編輯器中，點擊「執行」按鈕
2. 選擇 `test` 函數
3. 查看執行日誌確認沒有錯誤

### 6.2 正式執行
1. 選擇 `main` 函數
2. 點擊「執行」
3. 等待執行完成
4. 查看執行日誌

### 6.3 檢查結果
執行完成後，您會得到：
- 在試算表中生成的圖表
- 新的Google Slides簡報
- Google Drive中的CSV和分析報告檔案

## 第七步：自動化執行（可選）

### 7.1 設定觸發器
1. 在Apps Script編輯器中，點擊「觸發器」圖示
2. 點擊「新增觸發器」
3. 設定：
   - 要執行的函數：`main`
   - 事件來源：時間驅動
   - 時間型觸發器類型：日計時器
   - 時間：選擇您希望執行的時間

### 7.2 手動觸發
您也可以建立一個按鈕來手動觸發：
1. 在試算表中，前往「插入」>「繪圖」
2. 建立一個按鈕圖形
3. 將按鈕連結到Apps Script函數

## 常見問題解決

### Q: 出現「權限被拒絕」錯誤
A: 重新執行授權流程，確保所有權限都被授予

### Q: 圖表沒有生成
A: 檢查：
- 欄位索引是否正確
- 資料是否包含數值
- 圖表配置是否正確

### Q: 簡報沒有建立
A: 檢查：
- 是否啟用了Slides API
- 是否有足夠的權限建立檔案

### Q: 資料讀取失敗
A: 檢查：
- 試算表是否有資料
- 第一行是否為標題行
- 資料格式是否正確

## 進階功能

### 自定義圖表樣式
在 `createChart` 函數中可以修改：
- 圖表大小
- 顏色
- 標題樣式
- 軸標籤

### 自定義簡報樣式
在 `createPresentation` 函數中可以修改：
- 投影片佈局
- 字體樣式
- 顏色主題
- 投影片內容

### 資料篩選
可以在 `processData` 函數中加入：
- 資料篩選邏輯
- 資料分組
- 統計計算

## 支援的資料類型

- 文字資料
- 數值資料
- 日期資料
- 布林值資料

## 限制

- 每次執行最多處理10,000筆記錄
- 圖表數量建議不超過10個
- 簡報投影片數量建議不超過20張

---

**注意**: 這個解決方案完全在Google環境中執行，不需要任何外部API或金鑰，非常適合快速開始使用！
